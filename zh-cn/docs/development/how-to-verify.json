{
  "filename": "how-to-verify.md",
  "__html": "<h1>验证候选版本</h1>\n<p>详细的检查列表请参考: <a href=\"https://cwiki.apache.org/confluence/display/INCUBATOR/Incubator+Release+Checklist\">check list</a></p>\n<h2>1. 下载要发布的候选版本到本地环境</h2>\n<pre><code class=\"language-shell\">svn co https://dist.apache.org/repos/dist/dev/incubator/tubemq/${release_version}-${rc_version}/\n</code></pre>\n<h2>2. 验证上传的版本是否合规</h2>\n<blockquote>\n<p>开始验证环节，验证包含但不局限于以下内容和形式</p>\n</blockquote>\n<h3>2.1 查看发布包是否完整</h3>\n<blockquote>\n<p>上传到dist的包必须包含源码包，二进制包可选</p>\n</blockquote>\n<ol>\n<li>是否包含源码包</li>\n<li>是否包含源码包的签名</li>\n<li>是否包含源码包的sha512</li>\n<li>如果上传了二进制包，则同样检查(2)-(4)所列的内容</li>\n</ol>\n<h3>2.2 检查gpg签名</h3>\n<ul>\n<li>导入公钥</li>\n</ul>\n<pre><code class=\"language-shell\">curl https://dist.apache.org/repos/dist/dev/incubator/tubemq/KEYS &gt; KEYS # 下载KEYS\ngpg --import KEYS # 导入KEYS到本地\n</code></pre>\n<ul>\n<li>信任公钥</li>\n</ul>\n<blockquote>\n<p>信任此次版本所使用的KEY</p>\n</blockquote>\n<pre><code class=\"language-shell\">  gpg --edit-key xxxxxxxxxx #此次版本所使用的KEY\n  gpg (GnuPG) 2.2.21; Copyright (C) 2020 Free Software Foundation, Inc.\n  This is free software: you are free to change and redistribute it.\n  There is NO WARRANTY, to the extent permitted by law.\n  \n  Secret key is available.\n  \n  sec  rsa4096/5EF3A66D57EC647A\n       created: 2020-05-19  expires: never       usage: SC  \n       trust: ultimate      validity: ultimate\n  ssb  rsa4096/17628566FEED6AF7\n       created: 2020-05-19  expires: never       usage: E   \n  [ultimate] (1). Guangxu Cheng &lt;gxcheng@apache.org&gt;\n  \n<span class=\"hljs-meta\">  gpg&gt;</span><span class=\"bash\"> trust <span class=\"hljs-comment\">#信任</span></span>\n  sec  rsa4096/5EF3A66D57EC647A\n       created: 2020-05-19  expires: never       usage: SC  \n       trust: ultimate      validity: ultimate\n  ssb  rsa4096/17628566FEED6AF7\n       created: 2020-05-19  expires: never       usage: E   \n  [ultimate] (1). Guangxu Cheng &lt;gxcheng@apache.org&gt;\n  \n  Please decide how far you trust this user to correctly verify other users' keys\n  (by looking at passports, checking fingerprints from different sources, etc.)\n  \n    1 = I don't know or won't say\n    2 = I do NOT trust\n    3 = I trust marginally\n    4 = I trust fully\n    5 = I trust ultimately\n    m = back to the main menu\n  \n  Your decision? 5 #选择5\n  Do you really want to set this key to ultimate trust? (y/N) y #选择y\n                                                               \n  sec  rsa4096/5EF3A66D57EC647A\n       created: 2020-05-19  expires: never       usage: SC  \n       trust: ultimate      validity: ultimate\n  ssb  rsa4096/17628566FEED6AF7\n       created: 2020-05-19  expires: never       usage: E   \n  [ultimate] (1). Guangxu Cheng &lt;gxcheng@apache.org&gt;\n  \n<span class=\"hljs-meta\">  gpg&gt;</span><span class=\"bash\"> </span>\n       \n  sec  rsa4096/5EF3A66D57EC647A\n       created: 2020-05-19  expires: never       usage: SC  \n       trust: ultimate      validity: ultimate\n  ssb  rsa4096/17628566FEED6AF7\n       created: 2020-05-19  expires: never       usage: E   \n  [ultimate] (1). Guangxu Cheng &lt;gxcheng@apache.org&gt;\n</code></pre>\n<ul>\n<li>使用如下命令检查签名</li>\n</ul>\n<pre><code class=\"language-shell\">for i in *.tar.gz; do echo $i; gpg --verify $i.asc $i ; done\n<span class=\"hljs-meta\">#</span><span class=\"bash\">或者</span>\ngpg --verify apache-tubemq-${release_version}-src.tar.gz.asc apache-tubemq-${release_version}-src.tar.gz\n<span class=\"hljs-meta\">#</span><span class=\"bash\"> 如果上传二进制包，则同样需要检查二进制包的签名是否正确</span>\ngpg --verify apache-tubemq-server-${release_version}-bin.tar.gz.asc apache-tubemq-server-${release_version}-bin.tar.gz\ngpg --verify apache-tubemq-client-${release_version}-bin.tar.gz.asc apache-tubemq-client-${release_version}-bin.tar.gz\n</code></pre>\n<ul>\n<li>检查结果</li>\n</ul>\n<blockquote>\n<p>出现类似以下内容则说明签名正确，关键字：<strong><code>Good signature</code></strong></p>\n</blockquote>\n<pre><code class=\"language-shell\">apache-tubemq-0.3.0-incubating-src.tar.gz\ngpg: Signature made Sat May 30 11:45:01 2020 CST\ngpg:                using RSA key 9B12C2228BDFF4F4CFE849445EF3A66D57EC647A\ngpg: Good signature from \"Guangxu Cheng &lt;gxcheng@apache.org&gt;\" [ultimate]gular2\n</code></pre>\n<h3>2.3 检查sha512哈希</h3>\n<blockquote>\n<p>本地计算sha512哈希后，验证是否与dist上的一致</p>\n</blockquote>\n<pre><code class=\"language-shell\">for i in *.tar.gz; do echo $i; gpg --print-md SHA512 $i; done\n<span class=\"hljs-meta\">#</span><span class=\"bash\">或者</span>\ngpg --print-md SHA512 apache-tubemq-${release_version}-src.tar.gz\n<span class=\"hljs-meta\">#</span><span class=\"bash\"> 如果上传二进制包，则同样需要检查二进制包的sha512哈希</span>\ngpg --print-md SHA512 apache-tubemq-server-${release_version}-bin.tar.gz\ngpg --print-md SHA512 apache-tubemq-client-${release_version}-bin.tar.gz\n<span class=\"hljs-meta\">#</span><span class=\"bash\"> 或者</span>\nfor i in *.tar.gz.sha512; do echo $i; sha512sum -c $i; done\n</code></pre>\n<h3>2.4. 检查源码包的文件内容</h3>\n<p>解压缩<code>apache-tubemq-${release_version}-src.tar.gz</code>，进行如下检查:</p>\n<ul>\n<li>DISCLAIMER文件是否存在及内容是否正确</li>\n<li>LICENSE and NOTICE文件是否存在及内容是否正确</li>\n<li>所有文件是否带有ASF License头</li>\n<li>源码是否能够正常编译</li>\n<li>单测是否能够跑通</li>\n<li>....</li>\n</ul>\n<h3>2.5 检查二进制包(如果上传了二进制包)</h3>\n<p>解压缩<code>apache-tubemq-client-${release_version}-src.tar.gz</code>和<code>apache-tubemq-server-${release_version}-src.tar.gz</code>，进行如下检查:</p>\n<ul>\n<li>DISCLAIMER文件是否存在及内容是否正确</li>\n<li>LICENSE and NOTICE文件是否存在及内容是否正确</li>\n<li>能否正常部署成功</li>\n<li>部署测试环境、验证生产消费能否正常运行</li>\n<li>验证你认为可能会出问题的地方</li>\n<li>....</li>\n</ul>\n",
  "link": "/zh-cn/docs/development/how-to-verify.html",
  "meta": {
    "title": "如何验证版本- Apache TubeMQ"
  }
}