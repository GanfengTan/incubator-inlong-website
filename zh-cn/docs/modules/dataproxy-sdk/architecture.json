{
  "filename": "architecture.md",
  "__html": "<h1>一、说明</h1>\n<p>在业务使用消息接入方式时，业务一般仅需将数据按照proxy可识别的格式（如六段协议、数字化协议等）\n进行组包发送，就可以将数据接入到inlong。但为了保证数据可靠性、负载均衡、动态更新proxy列表等安全特性\n用户程序就需要考虑更多最终导致程序过于繁琐臃肿。</p>\n<p>API的设计初衷就是为了简化用户接入，承担部分可靠性相关的逻辑。用户通过在服务送程序中集成API后，即可将数据发送到proxy，而不用关心组包格式、负载均衡等逻辑。</p>\n<h1>二、功能说明</h1>\n<h2>2.1 整体功能说明</h2>\n<table>\n<thead>\n<tr>\n<th>功能</th>\n<th>详细描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>组包功能（新）</td>\n<td>将用户数据按proxy可识别的组包格式（如六段协议、数字化协议等）打包发送到TDBus</td>\n</tr>\n<tr>\n<td>压缩功能</td>\n<td>发送proxy前，将用户数据进行压缩，减少网络带宽占用</td>\n</tr>\n<tr>\n<td>维护TDBus列表</td>\n<td>每隔五分钟获取proxy列表 ，以检测运维侧是否存在上下线proxy机器的情况；每隔20s自动剔除不可用连接，以保证已连接的proxy能正常运作</td>\n</tr>\n<tr>\n<td>指标统计（新）</td>\n<td>增加业务分钟级别发送量的指标（接口级）</td>\n</tr>\n<tr>\n<td>负载均衡（新）</td>\n<td>使用新的策略将发送的数据在多个proxy间进行负载均衡，不再依靠简单的随机+轮询机制来保证</td>\n</tr>\n<tr>\n<td>proxy列表持久化（新）</td>\n<td>根据业务id对proxy列表持久化，防止程序启动时配置中心发生故障无法发送数据</td>\n</tr>\n</tbody>\n</table>\n<h2>2.2 数据发送功能说明</h2>\n<h3>同步批量函数</h3>\n<pre><code>public SendResult sendMessage(List&lt;byte[]&gt; bodyList, String bid, String tid, long dt, long timeout, TimeUnit timeUnit)\n\n参数说明\n\nbodyList是用户需要发送的多条数据的集合，总长度建议小于512k。bid代表业务id，tid代表接口id。dt表示该数据的时间戳，精确到毫秒级别。也可直接设置为0，此时api会后台获取当前时间作为其时间戳。timeout &amp; timeUnit:这两个参数是设置发送数据的超时时间，一般建议设置成20s。\n</code></pre>\n<p>###同步单条函数</p>\n<pre><code>public SendResult sendMessage(byte[] body, String bid, String tid, long dt, long timeout, TimeUnit timeUnit)\n\n参数说明\n\nbody是用户要发送的单条数据内容，其余各参数涵义基本与批量发送接口一致。\n</code></pre>\n<p>###异步批量函数</p>\n<pre><code>public void asyncSendMessage(SendMessageCallback callback, List&lt;byte[]&gt; bodyList, String bid, String tid, long dt, long timeout,TimeUnit timeUnit)\n\n参数说明\n\nSendMessageCallback 是处理消息的callback。bodyList为用户需要发送的多条数据的集合，多条数据的总长度建议小于512k。bid是业务id，tid是接口id。dt表示该数据的时间戳，精确到毫秒级别。也可直接设置为0，此时api会后台获取当前时间作为其时间戳。timeout和timeUnit是发送数据的超时时间，一般建议设置成20s。\n</code></pre>\n<p>###异步单条函数</p>\n<pre><code>public void asyncSendMessage(SendMessageCallback callback, byte[] body, String bid, String tid, long dt, long timeout, TimeUnit timeUnit)\n\n参数说明\n\nbody为单条消息内容，其余各参数涵义基本与批量发送接口一致\n</code></pre>\n",
  "link": "/zh-cn/docs/modules/dataproxy-sdk/architecture.html",
  "meta": {}
}