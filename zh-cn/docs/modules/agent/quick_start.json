{
  "filename": "quick_start.md",
  "__html": "<h2>1、配置</h2>\n<pre><code>cd inlong-agent\n</code></pre>\n<p>agent 支持本地运行以及线上运行，其中线上运行从inlong manager拉取任务，本地运行可使用http请求提交任务</p>\n<h3>1.1 Agent 线上运行相关设置</h3>\n<p>线上运行需要从inlong-manager拉取配置，配置conf/agent.properties如下：</p>\n<pre><code class=\"language-ini\"><span class=\"hljs-attr\">agent.fetcher.classname</span>=org.apache.inlong.agent.plugin.fetcher.ManagerFetcher (设置任务获取的类名，默认为ManagerFetcher）\n<span class=\"hljs-attr\">agent.local.ip</span>=写入本机ip\n<span class=\"hljs-attr\">agent.manager.vip.http.host</span>=manager web host\n<span class=\"hljs-attr\">agent.manager.vip.http.port</span>=manager web port\n</code></pre>\n<h3>1.2 DataProxy 相关设置</h3>\n<p>在agent目录下新建.inlong文件夹，内部新建bid+.local文件，例如设置的发送bid为a, 则新建a.local文件</p>\n<p>内部将写入：</p>\n<pre><code class=\"language-ini\">{\"cluster_id\":1,\"isInterVisit\":1,\"size\":1,\"address\": [{\"port\":写入proxy port,\"host\":\"写入proxy ip\"}], \"switch\":0}\n其中cluster_id, isInterVisit，switch为预留字段，请填写默认值\n</code></pre>\n<h2>2、运行</h2>\n<p>解压后如下命令运行</p>\n<pre><code class=\"language-bash\">sh agent.sh start\n</code></pre>\n<h3>3 实时添加job配置</h3>\n<h4>3.1 agent.propertities 修改下面两处</h4>\n<pre><code class=\"language-ini\"><span class=\"hljs-comment\"># whether enable http service</span>\n<span class=\"hljs-attr\">agent.http.enable</span>=<span class=\"hljs-literal\">true</span>\n<span class=\"hljs-comment\"># http default port</span>\n<span class=\"hljs-attr\">agent.http.port</span>=可用端口\n</code></pre>\n<h4>3.2 执行如下命令：</h4>\n<pre><code class=\"language-bash\">curl --location --request POST <span class=\"hljs-string\">'http://localhost:8018/config/job'</span> \\\n--header <span class=\"hljs-string\">'Content-Type: application/json'</span> \\\n--data <span class=\"hljs-string\">'{\n\"job\": {\n\"dir\": {\n\"path\": \"\",\n\"pattern\": \"/data/inlong-agent/test.log\"\n},\n\"trigger\": \"org.apache.inlong.agent.plugin.trigger.DirectoryTrigger\",\n\"id\": 1,\n\"thread\": {\n\"running\": {\n\"core\": \"4\"\n}\n},\n\"name\": \"fileAgentTest\",\n\"source\": \"org.apache.inlong.agent.plugin.sources.TextFileSource\",\n\"sink\": \"org.apache.inlong.agent.plugin.sinks.ProxySink\",\n\"channel\": \"org.apache.inlong.agent.plugin.channel.MemoryChannel\"\n},\n\"proxy\": {\n\"bid\": \"bid10\",\n\"tid\": \"bid10\"\n},\n\"op\": \"add\"\n}'</span>\n</code></pre>\n<pre><code>其中各个参数含义为：\n- job.dir.pattern: 配置读取的文件路径，可包含正则表达式\n- job.trigger: 触发器名称，默认为DirectoryTrigger，功能为监听文件夹下的文件产生事件，任务运行时已有的文件不会读取\n- job.source: 使用的数据源类型，默认为TextFileSource，读取文本文件\n- job.sink：使用的写入器类型，默认为ProxySink，发送消息到dataproxy中\n- proxy.bid: 写入proxy时使用的bid类型\n- proxy.tid: 写入proxy时使用的tid类型\n</code></pre>\n<h2>4、可支持的路径配置方案</h2>\n<pre><code>例如：\n/data/inlong-agent/test.log  //代表读取inlong-agent文件夹下的的新增文件test.log\n/data/inlong-agent/test[0-9]{1} //代表读取inlong-agent文件夹下的新增文件test后接一个数字结尾\n/data/inlong-agent/test //如果test为目录，则代表读取test下的所有新增文件\n/data/inlong-agent/^\\\\d+(\\\\.\\\\d+)? // 以一个或多个数字开头,之后可以是.或者一个.或多个数字结尾，?代表可选,可以匹配的实例：&quot;5&quot;, &quot;1.5&quot; 和 &quot;2.21&quot;\n</code></pre>\n",
  "link": "/zh-cn/docs/modules/agent/quick_start.html",
  "meta": {}
}