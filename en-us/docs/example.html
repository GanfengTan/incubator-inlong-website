<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta name="keywords" content="example" />
	<meta name="description" content="example" />
	<!-- 网页标签标题 -->
	<title>Hive Example - Apache InLong</title>
	<link rel="shortcut icon" href="/img/apache.ico"/>
	<link rel="stylesheet" href="/build/documentation.css" />
</head>
<body>
	<div id="root"><div class="documentation-page" data-reactroot=""><header class="header-container header-container-normal"><div class="header-body"><a href="/en-us/index.html"><a href="//www.apache.org"><img class="logo apache" style="width:120px" src="/img/asf_logo.svg"/></a><div class="logo-split"></div><img class="logo tube" style="width:120px;top:12px;position:absolute" src="/img/Tube logo.svg"/></a><div class="search search-normal"><span class="icon-search"></span></div><span class="language-switch language-switch-normal">中</span><div class="header-menu"><img class="header-menu-toggle" src="/img/system/menu_gray.png"/><div><ul class="ant-menu blackClass ant-menu-light ant-menu-root ant-menu-horizontal" role="menu"><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="/en-us/index.html" target="_self">HOME</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="/en-us/docs/quick_start.html" target="_self">DOCS</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="/en-us/docs/download/download.html" target="_self">DOWNLOAD</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="/en-us/docs/development/how-to-contribute.html" target="_self">DEVELOPMENT</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="https://github.com/apache/incubator-inlong" target="_self">GITHUB</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-submenu ant-menu-submenu-horizontal" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span class="submenu-title-wrapper">Apache</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li></ul></div></div></div><div class="header-background"></div></header><div class="bar"><div class="bar-body"><img src="/img/system/docs.png" class="front-img"/><span>Documentation</span><img src="/img/system/docs.png" class="back-img"/></div></div><section class="content-section"><div class="sidemenu"><div class="sidemenu-toggle"><img src="https://img.alicdn.com/tfs/TB1E6apXHGYBuNjy0FoXXciBFXa-200-200.png"/></div><ul><li class="menu-item menu-item-level-1"><span>User Guide</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/quick_start.html" target="_self">Quick Start</a></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/en-us/docs/example.html" target="_self">Hive Example</a></li></ul></li><li class="menu-item menu-item-level-1"><span>Components</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><span>Manager<img style="transform:rotate(-90deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/en-us/docs/modules/manager/architecture.html" target="_self">Architecture</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/modules/manager/user_manual.html" target="_self">Console Introduction</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/modules/manager/quick_start.html" target="_self">Build &amp;&amp; Deployment</a></li></ul></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><span>WebSite<img style="transform:rotate(-90deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/en-us/docs/modules/website/quick_start.html" target="_self">Build &amp;&amp; Deployment</a></li></ul></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><span>Agent<img style="transform:rotate(-90deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/en-us/docs/modules/agent/architecture.html" target="_self">Architecture</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/modules/agent/quick_start.html" target="_self">Build &amp;&amp; Deployment</a></li></ul></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><span>DataProxy<img style="transform:rotate(-90deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/en-us/docs/modules/dataproxy/architecture.html" target="_self">Architecture</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/modules/dataproxy/quick_start.html" target="_self">Build &amp;&amp; Deployment</a></li></ul></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><span>DataProxy-SDK<img style="transform:rotate(-90deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/en-us/docs/modules/dataproxy-sdk/architecture.html" target="_self">Architecture</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/modules/dataproxy-sdk/quick_start.html" target="_self">Build &amp;&amp; Deployment</a></li></ul></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><span>TubeMQ<img style="transform:rotate(-90deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/en-us/docs/modules/tubemq/architecture.html" target="_self">Architecture</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/modules/tubemq/quick_start.html" target="_self">Quick Start</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/modules/tubemq/configure_introduction.html" target="_self">Configure Introduction</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/modules/tubemq/console_introduction.html" target="_self">Console Introduction</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/modules/tubemq/client_rpc.html" target="_self">Client RPC</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/modules/tubemq/error_code.html" target="_self">Error Code</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/modules/tubemq/deployment.html" target="_self">Deployment Demo</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/modules/tubemq/http_access_api.html" target="_self">HTTP API</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/modules/tubemq/clients_java.html" target="_self">SDK Demo</a></li></ul></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><span>TubeMQ-Manager<img style="transform:rotate(-90deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/en-us/docs/modules/tubemq/tubemq-manager/quick_start.html" target="_self">Build &amp;&amp; Deployment</a></li></ul></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><span>Sort<img style="transform:rotate(-90deg)" class="menu-toggle" src="/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/en-us/docs/modules/sort/introduction.html" target="_self">Architecture</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/modules/sort/protocol_introduction.html" target="_self">Zookeeper Configure</a></li><li class="menu-item menu-item-level-3"><a href="/en-us/docs/modules/sort/quick_start.html" target="_self">Build &amp;&amp; Deployment</a></li></ul></li></ul></li><li class="menu-item menu-item-level-1"><span><div class="menu-item menu-item-level-1" style="margin-left:-20px"><a href="/en-us/docs/contact.html" target="_self" style="padding-left:20px">Contact Us</a></div></span><ul></ul></li></ul></div><div class="doc-content markdown-body"><p>Here we use a simple example to help you experience InLong by Docker.</p>
<h2>Install Hive</h2>
<p>Hive is the necessary component. If you don't have Hive in your machine, we recommand using Docker to install it. Details can be found <a href="https://github.com/big-data-europe/docker-hive">here</a>.</p>
<blockquote>
<p>Note that if you use Docker, you need to add a port mapping <code>8020:8020</code>, because it's the port of HDFS DefaultFS, and we need to use it later.</p>
</blockquote>
<h2>Install InLong</h2>
<p>Before we begin, we need to install InLong. Here we provide two ways:</p>
<ol>
<li>Install InLong with Docker by according to the <a href="https://github.com/apache/incubator-inlong/tree/master/docker/docker-compose">instructions here</a>.(Recommanded)</li>
<li>Install InLong binary according to the <a href="./quick_start.md">instructions here</a>.</li>
</ol>
<h2>Create a data access</h2>
<p>After deployment, we first enter the &quot;Data Access&quot; interface, click &quot;Create an Access&quot; in the upper right corner to create a new date access, and fill in the business information as shown in the figure below.</p>
<img src="../../img/create-business.png" align="center" alt="Create Business"/>
<p>Then we click the next button, and fill in the stream information as shown in the figure below.</p>
<img src="../../img/create-stream.png" align="center" alt="Create Stream"/>
<p>Note that the message source is &quot;File&quot;, and we don't need to create a message source manually.</p>
<p>Then we fill in the following information in the &quot;data information&quot; column below.</p>
<img src="../../img/data-information.png" align="center" alt="Data Information"/>
<p>Then we select Hive in the data flow and click &quot;Add&quot; to add Hive configuration</p>
<img src="../../img/hive-config.png" align="center" alt="Hive Config"/>
<p>Note that the target table does not need to be created in advance, as InLong Manager will automatically create the table for us after the access is approved. Also, please use connection test to ensure that InLong Manager can connect to your Hive.</p>
<p>Then we click the &quot;Submit for Approval&quot; button, the connection will be created successfully and enter the approval state.</p>
<h2>Approve the data access</h2>
<p>Then we enter the &quot;Approval Management&quot; interface and click &quot;My Approval&quot; to approve the data access that we just applied for.</p>
<p>At this point, the data access has been created successfully. We can see that the corresponding table has been created in Hive, and we can see that the corresponding topic has been created successfully in the management GUI of TubeMQ.</p>
<h2>Configure the agent</h2>
<p>Here we use <code>docker exec</code> to enter the container of the agent and configure it.</p>
<pre><code>$ docker exec -it agent sh
</code></pre>
<p>Then we create a directory of <code>.inlong</code>, and new a file named <code>bid.local</code> (Here bid is the business id) and fill in the configuration of Dataproxy as follows.</p>
<pre><code>$ mkdir .inlong
$ cd .inlong
$ touch b_test.local
$ echo '{&quot;cluster_id&quot;:1,&quot;isInterVisit&quot;:1,&quot;size&quot;:1,&quot;address&quot;: [{&quot;port&quot;:46801,&quot;host&quot;:&quot;dataproxy&quot;}], &quot;switch&quot;:0}' &gt;&gt; b_test.local
</code></pre>
<p>Then we exit the container, and use <code>curl</code> to make a request.</p>
<pre><code>curl --location --request POST 'http://localhost:8008/config/job' \
--header 'Content-Type: application/json' \
--data '{
&quot;job&quot;: {
&quot;dir&quot;: {
&quot;path&quot;: &quot;&quot;,
&quot;pattern&quot;: &quot;/data/collect-data/test.log&quot;
},
&quot;trigger&quot;: &quot;org.apache.inlong.agent.plugin.trigger.DirectoryTrigger&quot;,
&quot;id&quot;: 1,
&quot;thread&quot;: {
&quot;running&quot;: {
&quot;core&quot;: &quot;4&quot;
}
},
&quot;name&quot;: &quot;fileAgentTest&quot;,
&quot;source&quot;: &quot;org.apache.inlong.agent.plugin.sources.TextFileSource&quot;,
&quot;sink&quot;: &quot;org.apache.inlong.agent.plugin.sinks.ProxySink&quot;,
&quot;channel&quot;: &quot;org.apache.inlong.agent.plugin.channel.MemoryChannel&quot;
},
&quot;proxy&quot;: {
&quot;bid&quot;: &quot;b_test&quot;,
&quot;tid&quot;: &quot;test_stream&quot;
},
&quot;op&quot;: &quot;add&quot;
}'
</code></pre>
<p>At this point, the agent is configured successfully.
Then we need to create a new file <code>./collect-data/test.log</code> and add content to it to trigger the agent to send data to the dataproxy.</p>
<pre><code>$ touch collect-data/test.log
$ echo 'test,24' &gt;&gt; collect-data/test.log
</code></pre>
<p>Then we can observe the logs of agent and dataproxy, and we can see that the relevant data has been sent successfully.</p>
<pre><code>$ docker logs agent
$ docker logs dataproxy
</code></pre>
</div></section><footer class="footer-container"><div class="footer-body"><img src="/img/incubator-logo.svg"/><div class="cols-container"><div class="col col-24"><p>Apache InLong (incubating) is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.</p></div></div><div class="copyright"><span>Copyright © 2019-2020 The Apache Software Foundation. Apache InLong, InLong, and its feather logo are trademarks of The Apache Software Foundation.</span></div></div></footer></div></div>
	<script src="https://f.alicdn.com/react/15.4.1/react-with-addons.min.js"></script>
	<script src="https://f.alicdn.com/react/15.4.1/react-dom.min.js"></script>
	<script src="https://buttons.github.io/buttons.js"></script>
	<script>
		window.rootPath = '';
  </script>
	<script src="/build/documentation.js"></script>
</body>
</html>
