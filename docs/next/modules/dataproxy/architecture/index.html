<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache Inlong Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache Inlong Blog Atom Feed"><title data-react-helmet="true">Architecture | Apache Inlong</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://inlong.apache.org/docs/next/modules/dataproxy/architecture"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Architecture | Apache Inlong"><meta data-react-helmet="true" name="description" content="1 intro"><meta data-react-helmet="true" property="og:description" content="1 intro"><link data-react-helmet="true" rel="shortcut icon" href="/img/logo.svg"><link data-react-helmet="true" rel="canonical" href="https://inlong.apache.org/docs/next/modules/dataproxy/architecture"><link data-react-helmet="true" rel="alternate" href="https://inlong.apache.org/docs/next/modules/dataproxy/architecture" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://inlong.apache.org/zh-CN/docs/next/modules/dataproxy/architecture" hreflang="zh-CN"><link data-react-helmet="true" rel="alternate" href="https://inlong.apache.org/docs/next/modules/dataproxy/architecture" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.4ba64480.css">
<link rel="preload" href="/assets/js/runtime~main.5e459ba5.js" as="script">
<link rel="preload" href="/assets/js/main.37c2802e.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Apache" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/logo.svg" alt="Apache" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">Apache InLong</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/">HOME</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" href="/docs/user_guide/quick_start">DOC</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/user_guide/quick_start">Next</a></li><li><a class="dropdown__link" href="/docs/user_guide/quick_start">0.11.0</a></li><li><a class="dropdown__link" href="/versions/">All versions</a></li></ul></div><a class="navbar__item navbar__link" href="/download/main">DOWNLOAD</a><a class="navbar__item navbar__link" href="/development/how-to-contribute">DEVELOPMENT</a><a class="navbar__item navbar__link" href="/blog">BLOG</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link">ASF</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Foundation</a></li><li><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="dropdown__link">License</a></li><li><a href="https://www.apache.org/events/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Events</a></li><li><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Security</a></li><li><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Sponsorship</a></li><li><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Thanks</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg t="1631348384596" class="iconLanguage_EbrZ" viewBox="0 0 1024 1024" version="1.1" p-id="557" width="20" height="20"><path d="M547.797333 638.208l-104.405333-103.168 1.237333-1.28a720.170667 720.170667 0 0 0 152.490667-268.373333h120.448V183.082667h-287.744V100.906667H347.605333v82.218666H59.818667V265.386667h459.178666a648.234667 648.234667 0 0 1-130.304 219.946666 643.242667 643.242667 0 0 1-94.976-137.728H211.541333a722.048 722.048 0 0 0 122.453334 187.434667l-209.194667 206.378667 58.368 58.368 205.525333-205.525334 127.872 127.829334 31.232-83.84m231.424-208.426667h-82.218666l-184.96 493.312h82.218666l46.037334-123.306667h195.242666l46.464 123.306667h82.218667l-185.002667-493.312m-107.690666 287.744l66.56-178.005333 66.602666 178.005333z" fill="currentColor" p-id="558"></path></svg><span>English</span></span></a><ul class="dropdown__menu"><li><a href="/docs/next/modules/dataproxy/architecture" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">English</a></li><li><a href="/zh-CN/docs/next/modules/dataproxy/architecture" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">ç®€ä½“ä¸­æ–‡</a></li></ul></div><a href="https://github.com/apache/incubator-inlong" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_2i4l react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button class="clean-btn backToTopButton_i9tI" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menuLinkText_OKON">User Guide</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/user_guide/quick_start">Quick Start</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/user_guide/user_manual">User Manual</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/user_guide/example">Hive Example</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menuLinkText_OKON">Components</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menuLinkText_OKON" tabindex="0">Manager</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/modules/manager/architecture">Architecture</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/modules/manager/quick_start">Build &amp;&amp; Deployment</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menuLinkText_OKON" tabindex="0">Website</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/modules/website/quick_start">Build &amp;&amp; Deployment</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menuLinkText_OKON" tabindex="0">Agent</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/modules/agent/architecture">Architecture</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/modules/agent/quick_start">Build &amp;&amp; Deployment</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menuLinkText_OKON" tabindex="0">DataProxy</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/next/modules/dataproxy/architecture">Architecture</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/modules/dataproxy/quick_start">Build &amp;&amp; Deployment</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menuLinkText_OKON" tabindex="0">DataProxy-SDK</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/modules/dataproxy-sdk/architecture">Architecture</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/modules/dataproxy-sdk/quick_start">Build &amp;&amp; Deployment</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menuLinkText_OKON" tabindex="0">TubeMQ</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/modules/tubemq/architecture">Architecture</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/modules/tubemq/client_partition_assign_introduction">Introduction to client partition assign</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/modules/tubemq/client_rpc">Client RPC</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/modules/tubemq/clients_java">TubeMQ JAVA SDK API</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/modules/tubemq/configure_introduction">Configure Introduction</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/modules/tubemq/console_introduction">Console Introduction</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/modules/tubemq/consumer_example">Consumer Example</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/modules/tubemq/deployment">Deployment</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/modules/tubemq/error_code">Error Code</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/modules/tubemq/http_access_api">HTTP API</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/modules/tubemq/producer_example">Producer Example</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/modules/tubemq/quick_start">Quick Start</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menuLinkText_OKON" tabindex="0">tubemq-manager</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/modules/tubemq/tubemq-manager/quick_start">quick_start</a></li></ul></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/modules/tubemq/tubemq_perf_test_vs_Kafka_cn">Performance testing of TubeMQ vs Kafka</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menuLinkText_OKON" tabindex="0">Sort</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/modules/sort/introduction">Architecture</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/modules/sort/protocol_introduction">Zookeeper Configure</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/modules/sort/quick_start">Build &amp;&amp; Deployment</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/next/contact">Contact Us</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for <!-- -->Apache Inlong<!-- --> <b>Next</b> version.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs/modules/dataproxy/architecture">latest version</a></b> (<!-- -->0.11.0<!-- -->).</div></div><div class="docItemContainer_oiyr"><article><span class="theme-doc-version-badge badge badge--secondary">Version: <!-- -->Next</span><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Architecture</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="1-intro"></a>1 intro<a class="hash-link" href="#1-intro" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Inlong-dataProxy belongs to the inlong proxy layer and is used for data collection, reception and forwarding. Through format conversion, the data is converted into TDMsg1 format that can be cached and processed by the cache layer</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">InLong-dataProxy acts as a bridge from the InLong collection end to the InLong buffer end. Dataproxy pulls the relationship between the business group id and the corresponding topic name from the manager module, and internally manages the producers of multiple topics</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">The overall architecture of inlong-dataproxy is based on Apache Flume. On the basis of this project, inlong-bus expands the source layer and sink layer, and optimizes disaster tolerance forwarding, which improves the stability of the system.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="2-architecture"></a>2 architecture<a class="hash-link" href="#2-architecture" title="Direct link to heading">#</a></h2><p><img src="/assets/images/architecture-138d6143f4f9784999e3161f0797676e.png"></p><ol><li>The source layer opens port monitoring, which is realized through netty server. The decoded data is sent to the channel layer</li><li>The channel layer has a selector, which is used to choose which type of channel to go. If the memory is eventually full, the data will be processed.</li><li>The data of the channel layer will be forwarded through the sink layer. The main purpose here is to convert the data to the TDMsg1 format and push it to the cache layer (tube is more commonly used here)</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="3-dataproxy-support-configuration-instructions"></a>3 DataProxy support configuration instructions<a class="hash-link" href="#3-dataproxy-support-configuration-instructions" title="Direct link to heading">#</a></h2><p>DataProxy supports configurable source-channel-sink, and the configuration method is the same as the configuration file structure of flume:</p><p>Source configuration example and corresponding notes:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.sources.tcp-source.channels </span><span class="token operator">=</span><span class="token plain"> ch-msg1 ch-msg2 ch-msg3 ch-more1 ch-more2 ch-more3 ch-msg5 ch-msg6 ch-msg7 ch-msg8 ch-msg9 ch-msg10 ch-transfer ch -Back</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Define the channel used </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> the source. Note that </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> the configuration below this </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">source</span><span class="token plain"> uses the channel, it needs to be annotated here</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.sources.tcp-source.type </span><span class="token operator">=</span><span class="token plain"> org.apache.flume.source.SimpleTcpSource</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tcp resolution </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">type</span><span class="token plain"> definition, here provide the class name </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> instantiation, SimpleTcpSource is mainly to initialize the configuration and start port monitoring</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.sources.tcp-source.msg-factory-name </span><span class="token operator">=</span><span class="token plain"> org.apache.flume.source.ServerMessageFactory</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Handler used </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> message structure analysis, and </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">set</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">read</span><span class="token plain"> stream handler and </span><span class="token function" style="color:rgb(80, 250, 123)">write</span><span class="token plain"> stream handler</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.sources.tcp-source.host </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0.0</span><span class="token plain">.0.0</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tcp </span><span class="token function" style="color:rgb(80, 250, 123)">ip</span><span class="token plain"> binding monitoring, binding all network cards by default</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.sources.tcp-source.port </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">46801</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tcp port binding, port </span><span class="token number">46801</span><span class="token plain"> is bound by default</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.sources.tcp-source.highWaterMark</span><span class="token operator">=</span><span class="token number">2621440</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">The concept of netty, </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">set</span><span class="token plain"> the netty high water level value</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.sources.tcp-source.enableExceptionReturn</span><span class="token operator">=</span><span class="token plain">true</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">The new </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token plain"> of v1.7 version, optional, the default is false, used to </span><span class="token function" style="color:rgb(80, 250, 123)">open</span><span class="token plain"> the exception channel, when an exception occurs, the data is written to the exception channel to prevent other normal data transmission </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">the </span><span class="token function" style="color:rgb(80, 250, 123)">open</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">source</span><span class="token plain"> version does not </span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token plain"> this </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">, Details: Increase the </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">local</span><span class="token plain"> disk of abnormal data landing</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.sources.tcp-source.max-msg-length </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">524288</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Limit the size of a single package, here </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> the compressed package is transmitted, it is the compressed package size, the limit is 512KB</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.sources.tcp-source.topic </span><span class="token operator">=</span><span class="token plain"> test_token</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">The default topic value, </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> the mapping relationship between groupId and topic cannot be found, it will be sent to this topic</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.sources.tcp-source.attr </span><span class="token operator">=</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">m</span><span class="token operator">=</span><span class="token number">9</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">The default value of m is set, where the value of m is the version of inlong&#x27;s internal TdMsg protocol</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.sources.tcp-source.connections </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">5000</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Concurrent connections go online, new connections will be broken when the upper limit is exceeded</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.sources.tcp-source.max-threads </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">64</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Netty thread pool work thread upper limit, generally recommended to choose twice the cpu</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.sources.tcp-source.receiveBufferSize </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">524288</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Netty server tcp tuning parameters</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.sources.tcp-source.sendBufferSize </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">524288</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Netty server tcp tuning parameters</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.sources.tcp-source.custom-cp </span><span class="token operator">=</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Whether to use the self-developed channel process, the self-developed channel process can </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">select</span><span class="token plain"> the alternate channel to send when the main channel is blocked</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.sources.tcp-source.selector.type </span><span class="token operator">=</span><span class="token plain"> org.apache.flume.channel.FailoverChannelSelector</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">This channel selector is a self-developed channel selector, </span><span class="token function" style="color:rgb(80, 250, 123)">which</span><span class="token plain"> is not much different from the official website, mainly because of the channel master-slave selection logic</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.sources.tcp-source.selector.master </span><span class="token operator">=</span><span class="token plain"> ch-msg5 ch-msg6 ch-msg7 ch-msg8 ch-msg9</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Specify the master channel, these channels will be preferentially selected </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> data push. Those channels that are not </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> the master, transfer, fileMetric, and slaMetric configuration items, but are </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">There are defined channels </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> channels, </span><span class="token function" style="color:rgb(80, 250, 123)">which</span><span class="token plain"> are all classified as slave channels. When the master channel is full, the slave channel will be selected. Generally, the </span><span class="token function" style="color:rgb(80, 250, 123)">file</span><span class="token plain"> channel </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">type</span><span class="token plain"> is recommended </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> the slave channel.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.sources.tcp-source.selector.transfer </span><span class="token operator">=</span><span class="token plain"> ch-msg5 ch-msg6 ch-msg7 ch-msg8 ch-msg9</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Specify the transfer channel to accept the transfer </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">type</span><span class="token plain"> data. The transfer here generally refers to the data pushed to the non-tube cluster, </span><span class="token function" style="color:rgb(80, 250, 123)">which</span><span class="token plain"> is only </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> forwarding, and it is reserved </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> subsequent functions.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.sources.tcp-source.selector.fileMetric </span><span class="token operator">=</span><span class="token plain"> ch-back</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Specify the fileMetric channel to receive the metric data reported by the agent</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Channel configuration examples and corresponding annotations</p><p>memory channel</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.channels.ch-more1.type </span><span class="token operator">=</span><span class="token plain"> memory</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">memory channel </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">type</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.channels.ch-more1.capacity </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">10000000</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Memory channel queue size, the maximum number of messages that can be cached</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.channels.ch-more1.keep-alive </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.channels.ch-more1.transactionCapacity </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">20</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">The maximum number of batches are processed </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> atomic operations, and the memory channel needs to be locked when used, so there will be a batch process to increase efficiency</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>file channel</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.channels.ch-msg5.type </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">file</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">file</span><span class="token plain"> channel </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">type</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.channels.ch-msg5.capacity </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">100000000</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">The maximum number of messages that can be cached </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> a </span><span class="token function" style="color:rgb(80, 250, 123)">file</span><span class="token plain"> channel</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.channels.ch-msg5.maxFileSize </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1073741824</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">file</span><span class="token plain"> channel </span><span class="token function" style="color:rgb(80, 250, 123)">file</span><span class="token plain"> maximum limit, the number of bytes</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.channels.ch-msg5.minimumRequiredSpace </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1073741824</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">The minimum </span><span class="token function" style="color:rgb(80, 250, 123)">free</span><span class="token plain"> space of the disk where the </span><span class="token function" style="color:rgb(80, 250, 123)">file</span><span class="token plain"> channel is located. Setting this value can prevent the disk from being full</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.channels.ch-msg5.checkpointDir </span><span class="token operator">=</span><span class="token plain"> /data/work/file/ch-msg5/check</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">file</span><span class="token plain"> channel checkpoint path</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.channels.ch-msg5.dataDirs </span><span class="token operator">=</span><span class="token plain"> /data/work/file/ch-msg5/data</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">file</span><span class="token plain"> channel data path</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.channels.ch-msg5.fsyncPerTransaction </span><span class="token operator">=</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Whether to synchronize the disk </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> each atomic operation, it is recommended to change it to false, otherwise it will affect the performance</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.channels.ch-msg5.fsyncInterval </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">5</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">The </span><span class="token function" style="color:rgb(80, 250, 123)">time</span><span class="token plain"> interval between data flush from memory to disk, </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> seconds</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Sink configuration example and corresponding notes</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.sinks.meta-sink-more1.channel </span><span class="token operator">=</span><span class="token plain"> ch-msg1</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">The upstream channel name of the sink</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.sinks.meta-sink-more1.type </span><span class="token operator">=</span><span class="token plain"> org.apache.flume.sink.MetaSink</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">The sink class is implemented, where the message is implemented to push data to the tube cluster</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.sinks.meta-sink-more1.master-host-port-list </span><span class="token operator">=</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Tube cluster master node list</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.sinks.meta-sink-more1.send_timeout </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">30000</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Timeout limit when sending to tube</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.sinks.meta-sink-more1.stat-interval-sec </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">60</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Sink indicator statistics interval time, </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> seconds</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.sinks.meta-sink-more1.thread-num </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">8</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Sink class sends messages to the worker thread, </span><span class="token number">8</span><span class="token plain"> means to start </span><span class="token number">8</span><span class="token plain"> concurrent threads</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.sinks.meta-sink-more1.client-id-cache </span><span class="token operator">=</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent </span><span class="token function" style="color:rgb(80, 250, 123)">id</span><span class="token plain"> cache, used to check the data reported by the agent to remove duplicates</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.sinks.meta-sink-more1.max-survived-time </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">300000</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Maximum cache </span><span class="token function" style="color:rgb(80, 250, 123)">time</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">agent1.sinks.meta-sink-more1.max-survived-size </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">3000000</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Maximum number of caches</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="4-monitor-metrics-configuration-instructions"></a>4 Monitor metrics configuration instructions<a class="hash-link" href="#4-monitor-metrics-configuration-instructions" title="Direct link to heading">#</a></h2><p>  DataProxy provide monitor indicator based on JMX, user can implement the code that read the metrics and report to user-defined monitor system.
Source-module and Sink-module can add monitor metric class that is the subclass of org.apache.inlong.commons.config.metrics.MetricItemSet, and register it to MBeanServer. User-defined plugin can get module metric with JMX, and report metric data to different monitor system.</p><p>  User can describe the configuration in the file &quot;common.properties &quot;. For example:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">metricDomains</span><span class="token operator">=</span><span class="token plain">DataProxy</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">metricDomains.DataProxy.domainListeners</span><span class="token operator">=</span><span class="token plain">org.apache.inlong.dataproxy.metrics.prometheus.PrometheusMetricListener</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">metricDomains.DataProxy.snapshotInterval</span><span class="token operator">=</span><span class="token number">60000</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li><p>The JMX domain name of DataProxy is &quot;DataProxy&quot;. </p></li><li><p>It is defined by the parameter &quot;metricDomains&quot;.</p></li><li><p>The listeners of JMX domain is defined by the parameter &quot;metricDomains.$domainName.domainListeners&quot;.</p></li><li><p>The class names of the listeners is separated by the space char.</p></li><li><p>The listener class need to implement the interface &quot;org.apache.inlong.dataproxy.metrics.MetricListener&quot;.</p></li><li><p>The snapshot interval of the listeners is defined by the parameter &quot;metricDomains.$domainName.snapshotInterval&quot;, the parameter unit is &quot;millisecond&quot;.</p><p>The method proto of org.apache.inlong.dataproxy.metrics.MetricListener is:</p></li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">public void snapshot(String domain, List itemValues);</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>  The field of MetricItemValue.dimensions has these dimensions(The fields of DataProxyMetricItem defined by the Annotation &quot;@Dimension&quot;):</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">clusterId: DataProxy cluster ID.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sourceId: DataProxy </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">source</span><span class="token plain"> component name.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sourceDataId: DataProxy </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">source</span><span class="token plain"> component data id, when </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">source</span><span class="token plain"> is a TCP source, it will be port number.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">inlongGroupId: Inlong data group ID.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">inlongStreamId: Inlong data stream ID.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sinkId: DataProxy sink component name.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sinkDataId: DataProxy sink component data id, when sink is a pulsar sink, it will be topic name.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>  The field of MetricItemValue.metrics has these metrics(The fields of DataProxyMetricItem defined by the Annotation &quot;@CountMetric&quot;):</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">readSuccessCount: Successful event count reading from </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">source</span><span class="token plain"> component.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">readSuccessSize: Successful event body size reading from </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">source</span><span class="token plain"> component.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">readFailCount: Failure event count reading from </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">source</span><span class="token plain"> component.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">readFailSize: Failure event body size reading from </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">source</span><span class="token plain"> component.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sendCount: Event count sending to sink destination.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sendSize: Event body size sending to sink destination.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sendSuccessCount: Successful event count sending to sink destination.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sendSuccessSize: Successful event body size sending to sink destination.    </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sendFailCount: Failure event count sending to sink destination.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sendFailSize: Failure event body size sending to sink destination.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">sinkDuration: The unit is millisecond, the duration is between current timepoint and the timepoint </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> sending to sink destination.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">nodeDuration: The unit is millisecond, the duration is between current timepoint and the timepoint </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> getting event from source.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wholeDuration: The unit is millisecond, the duration is between current timepoint and the timepoint </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> generating event.</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>  Monitor indicators have registered to MBeanServer, user can append JMX parameters when running DataProxy, remote server can get monitor metrics with RMI.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">-Dcom.sun.management.jmxremote</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-Djava.rmi.server.hostname</span><span class="token operator">=</span><span class="token number">127.0</span><span class="token plain">.0.1</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-Dcom.sun.management.jmxremote.port</span><span class="token operator">=</span><span class="token number">9999</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-Dcom.sun.management.jmxremote.authenticate</span><span class="token operator">=</span><span class="token plain">false</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-Dcom.sun.management.jmxremote.ssl</span><span class="token operator">=</span><span class="token plain">false</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/apache/incubator-inlong-website/edit/master/docs/modules/dataproxy/architecture.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/next/modules/agent/quick_start"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->Build &amp;&amp; Deployment</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/next/modules/dataproxy/quick_start"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Build &amp;&amp; Deployment<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-intro" class="table-of-contents__link">1 intro</a></li><li><a href="#2-architecture" class="table-of-contents__link">2 architecture</a></li><li><a href="#3-dataproxy-support-configuration-instructions" class="table-of-contents__link">3 DataProxy support configuration instructions</a></li><li><a href="#4-monitor-metrics-configuration-instructions" class="table-of-contents__link">4 Monitor metrics configuration instructions</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://inlong.apache.org" target="_blank" rel="noopener noreferrer" class="footerLogoLink_SRtH"><img src="/img/incubator-logo.svg" alt="Apache Inlong" class="themedImage_TMUO themedImage--light_4Vu1 footer__logo"><img src="/img/incubator-logo.svg" alt="Apache Inlong" class="themedImage_TMUO themedImage--dark_uzRr footer__logo"></a></div><div class="footer__copyright"><div style="text-align: left;">
          <div>
            <p style="font-family: Avenir-Medium;font-size: 14px;color: #999;line-height: 20px;">Apache InLong (incubating) is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.</p>
          </div>
          <div style="border-top: 1px solid #ccc;min-height: 60px;line-height: 20px;text-align: center;font-family: Avenir-Medium;font-size: 14px;color: #999;display: flex;align-items: center;"><span>Copyright Â© 2019-2020 The Apache Software Foundation. Apache InLong, InLong, and its feather logo are trademarks of The Apache Software Foundation.</span></div>
        </div></div></div></div></footer></div>
<script src="/assets/js/runtime~main.5e459ba5.js"></script>
<script src="/assets/js/main.37c2802e.js"></script>
</body>
</html>